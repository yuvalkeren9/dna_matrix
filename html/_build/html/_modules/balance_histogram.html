

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>balance_histogram &mdash; DNA Strands in Matrix Final Project 1.00 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=da1d7f10"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DNA Strands in Matrix Final Project
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">project_files</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DNA Strands in Matrix Final Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">balance_histogram</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for balance_histogram</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Ensure these are correctly exported in main.py</span>
<span class="kn">from</span> <span class="nn">main</span> <span class="kn">import</span> <span class="n">create_random_strand</span><span class="p">,</span> <span class="n">DNA_BASES</span>
<span class="kn">from</span> <span class="nn">lookahead</span> <span class="kn">import</span> <span class="n">consume_logic_lookahead_one_v1</span><span class="p">,</span> <span class="n">consume_logic_lookahead_one_v2</span>
<span class="kn">from</span> <span class="nn">lookahead</span> <span class="kn">import</span> <span class="n">consume_logic_lookahead_one_v3</span><span class="p">,</span> <span class="n">consume_logic_lookahead_one_v4</span><span class="p">,</span> <span class="n">consume_logic_random</span>
<span class="kn">from</span> <span class="nn">main</span> <span class="kn">import</span> <span class="n">consume_with_logic</span>


<span class="c1">###############################################################################</span>
<span class="c1"># Helper Functions: Histograms and Imbalance</span>
<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="compute_histogram">
<a class="viewcode-back" href="../balance_histogram.html#balance_histogram.compute_histogram">[docs]</a>
<span class="k">def</span> <span class="nf">compute_histogram</span><span class="p">(</span><span class="n">strand</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the histogram of DNA bases for a given strand.</span>

<span class="sd">    :param strand: A string representing the DNA strand (e.g., &quot;ACGTAC&quot;).</span>
<span class="sd">    :return: A tuple (count_A, count_C, count_G, count_T).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">strand</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">),</span>
            <span class="n">strand</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">),</span>
            <span class="n">strand</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">),</span>
            <span class="n">strand</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">))</span></div>



<div class="viewcode-block" id="add_hist">
<a class="viewcode-back" href="../balance_histogram.html#balance_histogram.add_hist">[docs]</a>
<span class="k">def</span> <span class="nf">add_hist</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform element-wise addition of two 4-element histograms.</span>

<span class="sd">    :param h1: A 4-tuple of integers.</span>
<span class="sd">    :param h2: Another 4-tuple of integers.</span>
<span class="sd">    :return: A 4-tuple representing the element-wise sum.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">h1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">h2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">h1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">h1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">h2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">h1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">h2</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span></div>



<div class="viewcode-block" id="imbalance_std">
<a class="viewcode-back" href="../balance_histogram.html#balance_histogram.imbalance_std">[docs]</a>
<span class="k">def</span> <span class="nf">imbalance_std</span><span class="p">(</span><span class="n">hist</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the standard deviation of a 4-element histogram.</span>

<span class="sd">    :param hist: A 4-tuple (count_A, count_C, count_G, count_T).</span>
<span class="sd">    :return: A float indicating the imbalance (lower is more balanced).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">total</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">total</span> <span class="o">/</span> <span class="mf">4.0</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">hist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                      <span class="p">(</span><span class="n">hist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                      <span class="p">(</span><span class="n">hist</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                      <span class="p">(</span><span class="n">hist</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">)</span></div>



<span class="c1">###############################################################################</span>
<span class="c1"># Balanced Histogram Allocation</span>
<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="assign_strands_balanced_aggregate">
<a class="viewcode-back" href="../balance_histogram.html#balance_histogram.assign_strands_balanced_aggregate">[docs]</a>
<span class="k">def</span> <span class="nf">assign_strands_balanced_aggregate</span><span class="p">(</span><span class="n">dna_strands</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allocate DNA strands to m rows so that each row&#39;s overall base histogram</span>
<span class="sd">    is as balanced as possible.</span>

<span class="sd">    The algorithm works as follows:</span>
<span class="sd">      1. For each strand, compute its histogram and peak ratio (max(hist)/length).</span>
<span class="sd">      2. Sort strands by descending peak ratio (most skewed first).</span>
<span class="sd">      3. For each strand (in sorted order), assign it to the row (not yet full) that</span>
<span class="sd">         minimizes the increase in imbalance (standard deviation of cumulative histogram).</span>

<span class="sd">    :param dna_strands: List of DNA strands (total must be m*n).</span>
<span class="sd">    :param m: Number of rows.</span>
<span class="sd">    :return: A list of m rows, each row being a list of strands.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dna_strands</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">total</span> <span class="o">//</span> <span class="n">m</span>
    <span class="n">strand_info</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">dna_strands</span><span class="p">:</span>
        <span class="n">hist_s</span> <span class="o">=</span> <span class="n">compute_histogram</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">length_s</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">peak_s</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">hist_s</span><span class="p">)</span>
        <span class="n">pr</span> <span class="o">=</span> <span class="n">peak_s</span> <span class="o">/</span> <span class="n">length_s</span> <span class="k">if</span> <span class="n">length_s</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">strand_info</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">hist_s</span><span class="p">,</span> <span class="n">pr</span><span class="p">))</span>

    <span class="c1"># Sort by peak ratio descending</span>
    <span class="n">strand_info</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Initialize rows and cumulative histograms</span>
    <span class="n">Rows</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
    <span class="n">RowHist</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>

    <span class="c1"># Greedy assignment of each strand to the row with the smallest imbalance increase</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">hist_s</span><span class="p">,</span> <span class="n">pr</span><span class="p">)</span> <span class="ow">in</span> <span class="n">strand_info</span><span class="p">:</span>
        <span class="n">best_row</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">best_imbalance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Rows</span><span class="p">[</span><span class="n">r</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                <span class="n">candidate_hist</span> <span class="o">=</span> <span class="n">add_hist</span><span class="p">(</span><span class="n">RowHist</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">hist_s</span><span class="p">)</span>
                <span class="n">candidate_imb</span> <span class="o">=</span> <span class="n">imbalance_std</span><span class="p">(</span><span class="n">candidate_hist</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">candidate_imb</span> <span class="o">&lt;</span> <span class="n">best_imbalance</span><span class="p">:</span>
                    <span class="n">best_imbalance</span> <span class="o">=</span> <span class="n">candidate_imb</span>
                    <span class="n">best_row</span> <span class="o">=</span> <span class="n">r</span>
        <span class="n">Rows</span><span class="p">[</span><span class="n">best_row</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">RowHist</span><span class="p">[</span><span class="n">best_row</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_hist</span><span class="p">(</span><span class="n">RowHist</span><span class="p">[</span><span class="n">best_row</span><span class="p">],</span> <span class="n">hist_s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Rows</span></div>



<span class="c1">###############################################################################</span>
<span class="c1"># Random Assignment (Baseline)</span>
<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="assign_strands_random">
<a class="viewcode-back" href="../balance_histogram.html#balance_histogram.assign_strands_random">[docs]</a>
<span class="k">def</span> <span class="nf">assign_strands_random</span><span class="p">(</span><span class="n">dna_strands</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Randomly assign DNA strands to m rows.</span>

<span class="sd">    :param dna_strands: List of DNA strands (total must be m*n).</span>
<span class="sd">    :param m: Number of rows.</span>
<span class="sd">    :return: A list of m rows, each containing n strands.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dna_strands</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">total</span> <span class="o">//</span> <span class="n">m</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">total</span><span class="p">))</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span>
    <span class="n">Rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">subset</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">start</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span>
        <span class="n">row_strands</span> <span class="o">=</span> <span class="p">[</span><span class="n">dna_strands</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">]</span>
        <span class="n">Rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_strands</span><span class="p">)</span>
        <span class="n">start</span> <span class="o">+=</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">Rows</span></div>



<span class="c1">###############################################################################</span>
<span class="c1"># Synthesis Simulation (No Cycle Limit)</span>
<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="synthezise_no_limit">
<a class="viewcode-back" href="../balance_histogram.html#balance_histogram.synthezise_no_limit">[docs]</a>
<span class="k">def</span> <span class="nf">synthezise_no_limit</span><span class="p">(</span><span class="n">dna_list</span><span class="p">,</span> <span class="n">consume_func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate synthesis of a single row without imposing a cycle limit.</span>

<span class="sd">    The synthesis machine cycles through DNA_BASES until all strands are synthesized.</span>
<span class="sd">    The consumption function determines which strand is advanced at each cycle.</span>

<span class="sd">    :param dna_list: List of DNA strands.</span>
<span class="sd">    :param consume_func: Function to choose which strand to consume (e.g., lookahead or random).</span>
<span class="sd">    :return: Total number of cycles required.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cycles</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">base_idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">dna_list</span><span class="p">:</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">DNA_BASES</span><span class="p">[</span><span class="n">base_idx</span><span class="p">]</span>
        <span class="n">consume_with_logic</span><span class="p">(</span><span class="n">dna_list</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">consume_func</span><span class="p">)</span>
        <span class="n">cycles</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">base_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">DNA_BASES</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cycles</span></div>



<div class="viewcode-block" id="simulate_matrix_synthesis">
<a class="viewcode-back" href="../balance_histogram.html#balance_histogram.simulate_matrix_synthesis">[docs]</a>
<span class="k">def</span> <span class="nf">simulate_matrix_synthesis</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">consume_func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate synthesis of an entire matrix of DNA strands with no cycle limit.</span>

<span class="sd">    Each row is synthesized independently; the total synthesis time is the maximum</span>
<span class="sd">    number of cycles among all rows.</span>

<span class="sd">    :param matrix: List of rows (each row is a list of DNA strands).</span>
<span class="sd">    :param consume_func: Consumption function used for synthesis.</span>
<span class="sd">    :return: Maximum number of cycles among the rows.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">row_cycles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">matrix</span><span class="p">:</span>
        <span class="n">row_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">synthezise_no_limit</span><span class="p">(</span><span class="n">row_copy</span><span class="p">,</span> <span class="n">consume_func</span><span class="p">)</span>
        <span class="n">row_cycles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">row_cycles</span><span class="p">)</span></div>



<span class="c1">###############################################################################</span>
<span class="c1"># Experiment: Compare Allocation Methods</span>
<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="run_experiment">
<a class="viewcode-back" href="../balance_histogram.html#balance_histogram.run_experiment">[docs]</a>
<span class="k">def</span> <span class="nf">run_experiment</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">strand_length</span><span class="p">,</span> <span class="n">num_trials</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run multiple trials for a given matrix dimension (m rows, n columns).</span>

<span class="sd">    For each trial:</span>
<span class="sd">      - Generate m*n random DNA strands (each of length &#39;strand_length&#39;).</span>
<span class="sd">      - Allocate strands using both Balanced Histogram Allocation and Random Assignment.</span>
<span class="sd">      - Simulate synthesis using various consumption functions.</span>
<span class="sd">      - Compute the average cycle counts and the percentage improvement of Balanced vs Random.</span>

<span class="sd">    :param m: Number of rows.</span>
<span class="sd">    :param n: Number of strands per row.</span>
<span class="sd">    :param strand_length: Length of each DNA strand.</span>
<span class="sd">    :param num_trials: Number of trials for averaging.</span>
<span class="sd">    :return: Tuple (avg_results, improvement) where:</span>
<span class="sd">             avg_results: dict with average cycles for &quot;Balanced&quot; and &quot;Random&quot; methods.</span>
<span class="sd">             improvement: dict with percentage improvement per consumption function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">consume_funcs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Lookahead_v1&quot;</span><span class="p">:</span> <span class="n">consume_logic_lookahead_one_v1</span><span class="p">,</span>
        <span class="s2">&quot;Lookahead_v2&quot;</span><span class="p">:</span> <span class="n">consume_logic_lookahead_one_v2</span><span class="p">,</span>
        <span class="s2">&quot;Lookahead_v3&quot;</span><span class="p">:</span> <span class="n">consume_logic_lookahead_one_v3</span><span class="p">,</span>
        <span class="s2">&quot;Lookahead_v4&quot;</span><span class="p">:</span> <span class="n">consume_logic_lookahead_one_v4</span><span class="p">,</span>
        <span class="s2">&quot;Random&quot;</span><span class="p">:</span> <span class="n">consume_logic_random</span>
    <span class="p">}</span>
    <span class="n">total_strands</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Balanced&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consume_funcs</span><span class="p">},</span>
        <span class="s2">&quot;Random&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consume_funcs</span><span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_trials</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trial </span><span class="si">{</span><span class="n">trial</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">num_trials</span><span class="si">}</span><span class="s2"> (m=</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">, n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">strands</span> <span class="o">=</span> <span class="p">[</span><span class="n">create_random_strand</span><span class="p">(</span><span class="n">strand_length</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_strands</span><span class="p">)]</span>
        <span class="n">balanced_rows</span> <span class="o">=</span> <span class="n">assign_strands_balanced_aggregate</span><span class="p">(</span><span class="n">strands</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">random_rows</span> <span class="o">=</span> <span class="n">assign_strands_random</span><span class="p">(</span><span class="n">strands</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">consume_funcs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">cycles_bal</span> <span class="o">=</span> <span class="n">simulate_matrix_synthesis</span><span class="p">(</span><span class="n">balanced_rows</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
            <span class="n">cycles_rand</span> <span class="o">=</span> <span class="n">simulate_matrix_synthesis</span><span class="p">(</span><span class="n">random_rows</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Balanced&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cycles_bal</span><span class="p">)</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Random&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cycles_rand</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: Balanced = </span><span class="si">{</span><span class="n">cycles_bal</span><span class="si">}</span><span class="s2"> cycles, Random = </span><span class="si">{</span><span class="n">cycles_rand</span><span class="si">}</span><span class="s2"> cycles&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>

    <span class="n">avg_results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Balanced&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;Random&quot;</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="n">improvement</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="n">method</span><span class="p">]:</span>
            <span class="n">avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">method</span><span class="p">][</span><span class="n">name</span><span class="p">])</span>
            <span class="n">avg_results</span><span class="p">[</span><span class="n">method</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">avg</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consume_funcs</span><span class="p">:</span>
        <span class="n">rand_avg</span> <span class="o">=</span> <span class="n">avg_results</span><span class="p">[</span><span class="s2">&quot;Random&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
        <span class="n">bal_avg</span> <span class="o">=</span> <span class="n">avg_results</span><span class="p">[</span><span class="s2">&quot;Balanced&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
        <span class="n">improvement</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">rand_avg</span> <span class="o">-</span> <span class="n">bal_avg</span><span class="p">)</span> <span class="o">/</span> <span class="n">rand_avg</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">rand_avg</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Average Synthesis Cycles:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">avg_results</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">avg</span> <span class="ow">in</span> <span class="n">avg_results</span><span class="p">[</span><span class="n">method</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">avg</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> cycles&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Percentage Improvement of Balanced vs Random:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">imp</span> <span class="ow">in</span> <span class="n">improvement</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">imp</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">avg_results</span><span class="p">,</span> <span class="n">improvement</span></div>



<span class="c1">###############################################################################</span>
<span class="c1"># Experiments Over Multiple Matrix Sizes with Enhanced Graphs</span>
<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="run_experiments_for_sizes">
<a class="viewcode-back" href="../balance_histogram.html#balance_histogram.run_experiments_for_sizes">[docs]</a>
<span class="k">def</span> <span class="nf">run_experiments_for_sizes</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">strand_length</span><span class="p">,</span> <span class="n">num_trials</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For each square matrix size (m=n=size), run experiments and record:</span>
<span class="sd">      1) The percentage improvement (excluding the Random baseline).</span>
<span class="sd">      2) The absolute synthesis cycles for a chosen consumption function.</span>
<span class="sd">      3) A separate graph showing the difference (Random - Balanced).</span>

<span class="sd">    :param sizes: List of matrix sizes (integers).</span>
<span class="sd">    :param strand_length: Length of each DNA strand.</span>
<span class="sd">    :param num_trials: Number of trials per matrix size.</span>
<span class="sd">    :return: Tuple (improvement_data, avg_cycles_data_bal, avg_cycles_data_rand).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">consume_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Lookahead_v1&quot;</span><span class="p">,</span> <span class="s2">&quot;Lookahead_v2&quot;</span><span class="p">,</span> <span class="s2">&quot;Lookahead_v3&quot;</span><span class="p">,</span> <span class="s2">&quot;Lookahead_v4&quot;</span><span class="p">,</span> <span class="s2">&quot;Random&quot;</span><span class="p">]</span>
    <span class="n">consume_names_filtered</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consume_names</span> <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;Random&quot;</span><span class="p">]</span>

    <span class="n">improvement_data</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consume_names_filtered</span><span class="p">}</span>
    <span class="n">avg_cycles_data_bal</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consume_names</span><span class="p">}</span>
    <span class="n">avg_cycles_data_rand</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consume_names</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">size</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Running experiment for matrix size: </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> x </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">, strand_length=</span><span class="si">{</span><span class="n">strand_length</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">avg_results</span><span class="p">,</span> <span class="n">improvement</span> <span class="o">=</span> <span class="n">run_experiment</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">strand_length</span><span class="p">,</span> <span class="n">num_trials</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consume_names</span><span class="p">:</span>
            <span class="n">avg_cycles_data_bal</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_results</span><span class="p">[</span><span class="s2">&quot;Balanced&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">])</span>
            <span class="n">avg_cycles_data_rand</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_results</span><span class="p">[</span><span class="s2">&quot;Random&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consume_names_filtered</span><span class="p">:</span>
            <span class="n">improvement_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">improvement</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>

    <span class="c1"># Plot (1): Percentage improvement vs. matrix size (excluding Random)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consume_names_filtered</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">improvement_data</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Matrix Size (m = n)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Percentage Improvement (%)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Percentage Improvement of Balanced vs Random (No Cycle Limit)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Plot (2): Absolute cycles for a chosen consumption function</span>
    <span class="n">chosen</span> <span class="o">=</span> <span class="s2">&quot;Lookahead_v4&quot;</span>
    <span class="n">random_line</span> <span class="o">=</span> <span class="n">avg_cycles_data_rand</span><span class="p">[</span><span class="n">chosen</span><span class="p">]</span>
    <span class="n">balanced_line</span> <span class="o">=</span> <span class="n">avg_cycles_data_bal</span><span class="p">[</span><span class="n">chosen</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">random_line</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Random&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">balanced_line</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Balanced&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Matrix Size (m = n)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Average Synthesis Cycles&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absolute Cycles vs Matrix Size for </span><span class="si">{</span><span class="n">chosen</span><span class="si">}</span><span class="s2"> (No Cycle Limit)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Plot (3): Separate difference graph: (Random - Balanced)</span>
    <span class="n">difference_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="o">-</span> <span class="n">b</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">random_line</span><span class="p">,</span> <span class="n">balanced_line</span><span class="p">)]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">difference_line</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Matrix Size (m = n)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Difference in Cycles (Random - Balanced)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference in Cycles for </span><span class="si">{</span><span class="n">chosen</span><span class="si">}</span><span class="s2"> (No Cycle Limit)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">improvement_data</span><span class="p">,</span> <span class="n">avg_cycles_data_bal</span><span class="p">,</span> <span class="n">avg_cycles_data_rand</span></div>



<span class="c1">###############################################################################</span>
<span class="c1"># Main Runner</span>
<span class="c1">###############################################################################</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>  <span class="c1"># Square matrix sizes to test</span>
    <span class="n">strand_length</span> <span class="o">=</span> <span class="mi">200</span>
    <span class="n">num_trials</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Trials per matrix size</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running Balanced vs Random (No Cycle Limit) across multiple matrix sizes...&quot;</span><span class="p">)</span>
    <span class="n">run_experiments_for_sizes</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">strand_length</span><span class="p">,</span> <span class="n">num_trials</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Yuval keren, Aviran Sapir.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>